<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<style media="screen">
			input { display: block; }
			ul { list-style: none }
		</style>
		<title>Chat</title>
	</head>
	<body>
		Let's chat (from template)
		<ul id="message"></ul>
		<form id="chatbox">
			<textarea></textarea>
			<input type="submit" name="" value="Send" />
		</form>

		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js">
		</script>
		<script>
			$(function(){
					var socket = null;
					var msgBox = $("#chatbox textarea");
					var messages = $("#messages");
					$("#chatbox").submit(function(){
						if (!msgBox.val()) return false;
						if (!socket) {
							alert("Error: there is no socket connection.");
							return false;
						}
						socket.send(msgBox.val());
						msgBox.val("");
						return false;
					});
					if (!window["websocket"]){
						alert("Error: Your browser does not suppoer web sockets.")
					} else {
						socket = new WebSocket("ws://localhost:8081/room");
						socket.onclose = function() {
							alert("Connection has been closed.");
						}
						socket.onmessage = function(e) {
							messages.append($("<li>").text(e.data));
						}
					}
			})
		</script>
	</body>
</html>
